@page
@model Mango.Presentation.Pages.Coupons.IndexModel
@{
}

@Layout = "_Layout";

<html xmlns="http://www.w3.org/1999/xhtml">
    <head><title></title></head>
    <body>
    <button onclick="listarCoupons()" class="btn btn-primary mb-3">List Coupons</button>
    </body>
</html>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
        function listarCoupons() {
            // Define a URL para o seu método da Controller
            // Exemplo: /Product/GetAll (se a Controller for ProductController)
            var url = '/Coupons/GetAll';

            $.ajax({
                url: url,
                type: 'GET', // Método HTTP
                dataType: 'json', // O tipo de dado que esperamos receber

                success: function(response) {
                    // 🚀 SUCCESSO: O que fazer com os dados recebidos
                    var dataList = $('#dataList');
                    dataList.empty(); // Limpa a lista antes de adicionar novos itens

                    $.each(response, function(index, item) {
                        dataList.append('<li>ID: ' + item.Id + ', Nome: ' + item.Name + ', Preço: $' + item.Price.toFixed(2) + '</li>');
                    });
                    console.log("Dados carregados com sucesso!", response);
                },

                error: function(xhr, status, error) {
                    // 🛑 ERRO: O que fazer se a chamada falhar
                    console.error("Erro na chamada AJAX:", status, error);
                    alert("Erro ao carregar os dados. Verifique o console.");
                }
            });
        }

    </script>
}
